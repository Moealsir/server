#!/bin/bash

# Cloudflare API credentials
CLOUDFLARE_API_TOKEN="your_cloudflare_api_token"
CLOUDFLARE_ZONE_ID="your_cloudflare_zone_id"

# Function to create a DNS record in Cloudflare
create_dns_record() {
    local subdomain="$1"

    # Replace example.com with your domain name
    local zone_name="moealsir.tech"
    local record_type="CNAME"
    local ip_address="54.226.6.57"

    # Send API request to create DNS record
    curl -s -X POST "https://api.cloudflare.com/client/v4/zones/$CLOUDFLARE_ZONE_ID/dns_records" \
    -H "Authorization: Bearer $CLOUDFLARE_API_TOKEN" \
    -H "Content-Type: application/json" \
    --data "{\"type\":\"$record_type\",\"name\":\"$subdomain.$zone_name\",\"content\":\"$ip_address\",\"ttl\":120,\"proxied\":false}" \
    | jq -r '.success'
}

# Function to delete a DNS record in Cloudflare
delete_dns_record() {
    local subdomain="$1"

    # Send API request to fetch DNS record ID
    local dns_record_id=$(curl -s -X GET "https://api.cloudflare.com/client/v4/zones/$CLOUDFLARE_ZONE_ID/dns_records?type=A&name=$subdomain.$DOMAIN" \
    -H "Authorization: Bearer $CLOUDFLARE_API_TOKEN" \
    -H "Content-Type: application/json" \
    | jq -r '.result[0].id')

    # Send API request to delete DNS record
    curl -s -X DELETE "https://api.cloudflare.com/client/v4/zones/$CLOUDFLARE_ZONE_ID/dns_records/$dns_record_id" \
    -H "Authorization: Bearer $CLOUDFLARE_API_TOKEN" \
    -H "Content-Type: application/json" \
    | jq -r '.success'
}

# Function to create a new subdomain
create_subdomain() {
    echo "Creating a subdomain..."
    read -p "Enter the subdomain name: " subdomain

    if [ -z "$subdomain" ]; then
        echo "Subdomain name cannot be empty."
        exit 1
    fi

    # Create subdomain locally
    # Your existing code for creating subdomain goes here

    # Create DNS record in Cloudflare
    create_dns_record "$subdomain" && echo "DNS record created successfully."
}

# Function to delete a subdomain
delete_subdomain() {
    echo "Deleting a subdomain..."
    read -p "Enter the subdomain name: " subdomain

    if [ -z "$subdomain" ]; then
        echo "Subdomain name cannot be empty."
        exit 1
    fi

    # Delete subdomain locally
    # Your existing code for deleting subdomain goes here

    # Delete DNS record in Cloudflare
    delete_dns_record "$subdomain" && echo "DNS record deleted successfully."
}

# Rest of your script remains unchanged...
